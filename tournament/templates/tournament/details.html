{% extends "frame/base.html" %}

{% block content %}
{% if messages %}
    {% for message in messages %}
    <li {% if message.tags %} class="{{ message.tags }}" {% endif %}>{{ message }}</li>
    {% endfor %}
{% endif %}

    <h1>{{tournament.name}}</h1>
    <p>{{tournament.description}}</p>

    {% if tournament.status == 0 %}
        <h3>Standings</h3>
        <p>Tournament has finished</p>

        {% if user == tournament.owner %}
            <div class="col-2" style="text-align: right; padding-top: 10px;">
                <a href="{% url 'tournament-report' tournament_id=tournament.pk %}"><i class="fas fa-pen fa-2x"></i></a>
            </div>
        {% endif %}

        <table class="table table-dark">
            <thead>
            <tr>
                <th scope="col">Placement</th>
                <th scope="col">Participant</th>
                <th scope="col">Result</th>
                <th scope="col">Leaguepoints</th>
            </tr>
            </thead>
            <h1></h1>
            {% for standing in standings %}
                <div>
                    <tr>
                        <td>{{ standing.0 }}</td>
                        <td><a href="{% url 'profile-datail' user_id=standing.1.pk %}">{{ standing.1 }}</a></td>
                        <td>{{standing.2}}</td>
                        <td>{{standing.3}}</td>
                    </tr>
                </div>
            {% endfor %}
            </tbody>
        </table>
    {% else %}
        {% if user == tournament.owner %}
            <div class="col-2" style="text-align: right; padding-top: 10px;">
                <a href="{% url 'tournament-report' tournament_id=tournament.pk %}"><i class="fas fa-pen fa-2x"></i></a>
            </div>
        {% endif %}
        {% if standings %}
        <form method="POST" class="post-form">
            {% csrf_token %}
            <button type="submit" class="save btn btn-default btn-primary" name="action" value="finish">Finish Tournament</button>
        </form>
        <p>{{tournament.description}}</p>



        <table class="table table-dark">
            <thead>
            <tr>
                <th scope="col">Participant</th>
                <th scope="col">Time</th>
            </tr>
            </thead>
            <tbody>
            <h1></h1>
            {% for standing in standings %}
                <div>
                    <tr>
                        <td><a href="#">{{standing.user}}</a></td>
                        <td>{{standing.result}}</td>
                    </tr>
                </div>
            {% endfor %}
            </tbody>
        </table>

        {% endif %}

    {% if user == tournament.owner %}
        <p>Add results:</p>
        <form method="POST" class="post-form">
            {% csrf_token %}
            {{ report_form.as_p }}
            <button type="submit" class="save btn btn-default btn-primary" name="action" value="save">Save</button>
        </form>

    {% else %}
        <div>
            You need to be tournament owner to report results.
        </div>
    {% endif %}
    {% endif %}


<!-- Modal -->
{% include 'modals/register_team.html' %}
{% include 'modals/delete_team.html' %}


{% endblock %}
